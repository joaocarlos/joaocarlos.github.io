{{- with site.Params.profileMode }}

<!-- Sticky Navigation Bar + Mobile Menu (placed at top) -->
{{- with .buttons }} {{- $currentPath := $.RelPermalink -}}

<!-- Sticky Navigation Bar -->
<div class="sticky-nav">
    <div class="sticky-nav-inner">
        <!-- Mobile: Hamburger menu button -->
        <div class="sticky-nav-mobile">
            <button
                data-action="open-menu"
                class="mobile-menu-trigger"
                aria-label="Open Menu"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                >
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
        </div>

        <!-- Desktop: Navigation buttons -->
        {{- partial "site-nav.html" $ }}
    </div>
</div>

<!-- Mobile Navigation Drawer (hidden by default) -->
{{- partial "mobile-menu.html" $ }}
{{- end }}

<!-- Main Header - Profile Info (matches TSX structure) -->
<header class="profile-header">
    <div class="profile-header-inner">
        {{- if .imageUrl -}} {{- $img := "" }} {{- if not (urls.Parse
        .imageUrl).IsAbs }} {{- $img = resources.Get .imageUrl }} {{- end }} {{-
        if $img }} {{- $processableFormats := (slice "jpg" "jpeg" "png" "tif"
        "bmp" "gif") -}} {{- if hugo.IsExtended -}} {{- $processableFormats =
        $processableFormats | append "webp" -}} {{- end -}} {{- $prod :=
        (hugo.IsProduction | or (eq site.Params.env "production")) }} {{- if and
        (in $processableFormats $img.MediaType.SubType) (eq $prod true)}} {{- if
        (not (and (not .imageHeight) (not .imageWidth))) }} {{- $img =
        $img.Resize (printf "%dx%d" .imageWidth .imageHeight) }} {{- else if
        .imageHeight }} {{- $img = $img.Resize (printf "x%d" .imageHeight) }}
        {{- else if .imageWidth }} {{- $img = $img.Resize (printf "%dx"
        .imageWidth) }} {{- else }} {{- $img = $img.Resize "128x128" }} {{- end
        }} {{- end }}
        <div class="profile-avatar">
            <img draggable="false" src="{{ $img.Permalink }}" alt="{{
            .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
            />
        </div>
        {{- else }}
        <div class="profile-avatar">
            <img draggable="false" src="{{ .imageUrl | absURL }}" alt="{{
            .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
            />
        </div>
        {{- end }} {{- end }}

        <h1 class="profile-title">
            {{ .title | default site.Title | markdownify }}
        </h1>

        {{- if .position }}
        <p class="profile-subtitle">{{ .position | markdownify }}</p>
        {{- end }} {{- if .intro }}
        <p class="profile-institution">{{ .intro | markdownify }}</p>
        {{- else if .subtitle }}
        <p class="profile-institution">{{ .subtitle | markdownify }}</p>
        {{- end }}

        <!-- Social icons: Desktop only, hidden on mobile since they're in the menu -->
        <div class="profile-header-socials">
            {{- partial "social_icons.html" -}}
        </div>
    </div>
</header>

{{- end}}
